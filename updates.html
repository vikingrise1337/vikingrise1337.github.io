<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viking Rise Update Notes</title>
    <meta name="theme-color" content="#d4af37">
    <meta property="og:title" content="Viking Rise Community Hub">
    <meta property="og:description" content="Der inoffizielle Hub für Viking Rise: Aktuelle Patch Notes, Wartungs-Timer und News auf Deutsch & Englisch.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://vikingrise1337.github.io/">
    <meta property="og:image" content="https://vikingrise1337.github.io/favicon.png">
    <meta name="twitter:card" content="summary">
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="apple-touch-icon" href="favicon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8083367890134296" crossorigin="anonymous"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@500;700;900&family=Roboto:wght@300;400;500&display=swap');
        
        body { font-family: 'Roboto', sans-serif; background-color: #0b101b; }
        .viking-font { font-family: 'Cinzel', serif; }
        .glass-panel { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(10px); }
        .gold-text { color: #d4af37; }
        
        /* Listen Styles */
        ul.detail-list { list-style: none; padding: 0; margin: 0; }
        ul.detail-list li { position: relative; padding-left: 24px; margin-bottom: 8px; font-size: 0.9rem; color: #cbd5e1; line-height: 1.5; }
        ul.detail-list li::before { content: "•"; position: absolute; left: 8px; color: #64748b; font-weight: bold; }
        
        /* Dropdown Styles */
        details {
            margin-bottom: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        details[open] { border-color: #d4af37; background: rgba(0, 0, 0, 0.3); }
        details > summary { 
            list-style: none; padding: 15px; background: rgba(255, 255, 255, 0.05); cursor: pointer; font-weight: bold; color: #e2e8f0; display: flex; justify-content: space-between; align-items: center; transition: background 0.2s;
        }
        details > summary:hover { background: rgba(212, 175, 55, 0.1); color: #d4af37; }
        details > summary::-webkit-details-marker { display: none; }
        .dropdown-content { padding: 15px; border-top: 1px solid rgba(255, 255, 255, 0.1); color: #94a3b8; font-size: 0.9rem; line-height: 1.6; }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        .lang-active { color: #d4af37; font-weight: bold; }
        .lang-inactive { color: #64748b; }
        .lang-inactive:hover { color: white; }

        /* --- MOBILE FIXES --- */
        @media (max-width: 768px) {
            .header-mobile-fix {
                height: auto !important;
                min-height: 24rem; 
                padding-bottom: 5rem !important; /* Viel Platz für das Dropdown */
            }
            h1 { font-size: 2rem !important; }
            .dropdown-wrapper {
                margin-top: 1rem !important;
                width: 100%;
            }
            #local-time-display {
                font-size: 1.1rem !important; /* Schrift kleiner damit es passt */
                white-space: nowrap; 
            }
            #local-time-display span { font-size: 0.8rem !important; }
        }
    </style>
</head>
<body class="min-h-screen pb-20 text-gray-200">

    <nav class="w-full z-50 border-b border-white/10 bg-[#0b101b]">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="index.html?lang=de" class="flex items-center gap-2 hover:opacity-80 transition">
                <span class="material-symbols-outlined text-gray-400">arrow_back</span>
                <span class="viking-font text-lg font-bold text-white">Zurück zur <span class="text-[#d4af37]">Startseite</span></span>
            </a>
            <div class="flex items-center gap-2">
                <a href="updates.html?lang=de" class="text-xs lang-active">DE</a>
                <span class="text-xs text-white/20">|</span>
                <a href="updates_en.html" class="text-xs lang-inactive transition-colors">EN</a>
            </div>
        </div>
    </nav>

    <div class="header-mobile-fix relative w-full h-80 md:h-96 overflow-hidden border-b-4 border-[#d4af37] mb-12">
        <img src="header-bg.jpg" alt="Viking Update Hero" class="absolute inset-0 w-full h-full object-cover opacity-80" style="object-position: center top;">
        <div class="absolute inset-0 bg-gradient-to-t from-[#0b101b] via-transparent to-transparent"></div>
        
        <div class="absolute bottom-0 left-0 p-6 md:p-12 w-full flex flex-col items-start justify-end h-full">
            <span class="inline-block px-3 py-1 mb-2 text-xs font-bold tracking-wider text-black bg-[#d4af37] rounded uppercase">Update Archiv</span>
            <h1 class="text-4xl md:text-6xl font-bold text-white drop-shadow-lg mb-2 viking-font">Patch Notes</h1>
            
            <div class="dropdown-wrapper mt-4 relative inline-block w-full md:w-auto">
                <select id="version-select" onchange="changeVersion(this.value)" class="appearance-none bg-black/60 border border-[#d4af37] text-white py-2 px-4 pr-10 rounded leading-tight focus:outline-none focus:bg-black/80 focus:border-white cursor-pointer hover:bg-black/70 transition w-full md:w-auto backdrop-blur-sm">
                    <option>Lade Versionen...</option>
                </select>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-[#d4af37]">
                    <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                </div>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4 -mt-10 relative z-10">
        <div class="glass-panel rounded-xl p-6 mb-8 border border-gray-700 flex flex-col md:flex-row items-center justify-between gap-4 shadow-xl">
            <div class="flex items-center gap-4">
                <span class="material-symbols-outlined text-4xl gold-text">schedule</span>
                <div>
                    <h2 class="text-lg font-bold text-white">Wartungszeitraum (UTC)</h2>
                    <p id="utc-time-display" class="text-sm text-gray-400">--</p>
                </div>
            </div>
            <div class="text-center md:text-right bg-black/30 p-3 rounded-lg border border-gray-700 w-full md:w-auto">
                <p class="text-xs text-gray-400 uppercase tracking-widest mb-1">Wartungsbeginn (Bei dir)</p>
                <p id="local-time-display" class="text-xl font-mono text-[#d4af37] font-bold">--:--</p>
            </div>
        </div>

        <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
            <div class="flex gap-2 bg-[#1e293b] p-1 rounded-lg border border-gray-700">
                <button id="btn-all" onclick="filterContent('all')" class="px-4 py-2 rounded-md text-sm font-bold bg-[#d4af37] text-black transition-colors">Alle</button>
                <button id="btn-major" onclick="filterContent('major')" class="px-4 py-2 rounded-md text-sm font-bold text-gray-400 hover:text-white transition-colors">Highlights</button>
                <button id="btn-opt" onclick="filterContent('opt')" class="px-4 py-2 rounded-md text-sm font-bold text-gray-400 hover:text-white transition-colors">Details</button>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div id="major-updates-section" class="lg:col-span-2 space-y-8">
                
                <div class="glass-panel rounded-xl overflow-hidden shadow-lg border border-gray-700 group hover:border-[#d4af37] transition-all duration-300 filter-item major">
                    <div class="relative h-64 overflow-hidden">
                        <img src="surtr.jpg" alt="Surtrs Flammen" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
                        <div class="absolute inset-0 bg-gradient-to-t from-[#0b101b] to-transparent"></div>
                        <h3 class="absolute bottom-4 left-4 text-2xl font-bold text-white drop-shadow-lg viking-font">Surtrs Flammen <span class="text-sm bg-red-600/80 px-2 py-0.5 rounded ml-2 align-middle font-sans text-white">KVK Saison</span></h3>
                    </div>
                    <div class="p-6">
                        <p class="text-gray-300 leading-relaxed">Die Königreich-Chaos Eroberungssaison beginnt! Wikinger, kämpft, um Surtrs Flammen zu löschen!</p>
                    </div>
                </div>

                <div class="glass-panel rounded-xl overflow-hidden shadow-lg border border-gray-700 group hover:border-[#d4af37] transition-all duration-300 filter-item major">
                    <div class="relative h-64 overflow-hidden">
                        <img src="dragon.jpg" alt="Drachenzähmen" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" style="object-position: top center;">
                        <div class="absolute inset-0 bg-gradient-to-t from-[#0b101b] to-transparent"></div>
                        <h3 class="absolute bottom-4 left-4 text-2xl font-bold text-white drop-shadow-lg viking-font">Drachenzähmen <span class="text-sm bg-blue-600/80 px-2 py-0.5 rounded ml-2 align-middle font-sans text-white">Kollaboration</span></h3>
                    </div>
                    <div class="p-6">
                        <p class="text-gray-300 leading-relaxed">Partnering mit &lt;Drachenzähmen leicht gemacht&gt;. Erkundet eine neue Fantasiewelt!</p>
                    </div>
                </div>

                <div class="glass-panel rounded-xl overflow-hidden shadow-lg border border-gray-700 group hover:border-[#d4af37] transition-all duration-300 filter-item major">
                    <div class="relative h-64 overflow-hidden">
                        <img src="christmas.jpg" alt="Weihnachten" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
                        <div class="absolute inset-0 bg-gradient-to-t from-[#0b101b] to-transparent"></div>
                        <h3 class="absolute bottom-4 left-4 text-2xl font-bold text-white drop-shadow-lg viking-font">Weihnachts-Event <span class="text-sm bg-green-600/80 px-2 py-0.5 rounded ml-2 align-middle font-sans text-white">Event</span></h3>
                    </div>
                    <div class="p-6">
                        <p class="text-gray-300 leading-relaxed">Kutschenrennen und neue Skins warten auf euch!</p>
                    </div>
                </div>

            </div>

            <div id="details-section" class="lg:col-span-1 space-y-6">
                <div class="glass-panel p-5 rounded-xl border border-gray-700 filter-item opt">
                    <h3 class="text-xl font-bold text-[#d4af37] mb-4 flex items-center gap-2 viking-font">
                        <span class="material-symbols-outlined">radio_button_unchecked</span> Neu
                    </h3>
                    <ul class="detail-list" id="list-new"></ul>
                </div>

                <div class="glass-panel p-5 rounded-xl border border-gray-700 filter-item opt">
                    <h3 class="text-xl font-bold text-blue-400 mb-4 flex items-center gap-2 viking-font">
                        <span class="material-symbols-outlined">tune</span> Optimierungen
                    </h3>
                    <div id="opt-container" class="space-y-2"></div>
                </div>

                <div class="glass-panel p-5 rounded-xl border border-gray-700 filter-item opt">
                    <h3 class="text-xl font-bold text-green-400 mb-4 flex items-center gap-2 viking-font">
                        <span class="material-symbols-outlined">pest_control</span> Fehlerbehebungen
                    </h3>
                    <ul class="detail-list" id="list-fixes"></ul>
                </div>
                
                <div class="glass-panel p-4 rounded-xl border border-gray-700 flex flex-col items-center mt-6">
                    <span class="text-[10px] uppercase tracking-widest text-gray-500 mb-2 w-full text-left">Anzeige</span>
                    <ins class="adsbygoogle" style="display:block; width: 100%;" data-ad-client="ca-pub-8083367890134296" data-ad-slot="5743006522" data-ad-format="auto" data-full-width-responsive="true"></ins>
                    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
                </div>
            </div>
        </div>
        <div class="text-center mt-12 mb-4 text-gray-600 text-xs">Unofficial Patch Notes Page</div>
    </div>

    <script>
        let allPatchData = [];

        async function init() {
            try {
                const response = await fetch('patchnotes.json');
                allPatchData = await response.json();
                
                const selector = document.getElementById('version-select');
                selector.innerHTML = '';
                
                allPatchData.forEach((update, index) => {
                    const option = document.createElement('option');
                    option.value = index;
                    option.text = update.meta?.title_de || `Update #${index+1}`;
                    selector.appendChild(option);
                });

                loadUpdate(0);

            } catch (error) { console.error("Fehler:", error); }
        }

        function loadUpdate(index) {
            const update = allPatchData[index];
            if(!update) return;

            const data = update.de;
            const meta = update.meta;

            const fillList = (id, items) => {
                const el = document.getElementById(id);
                if(el) el.innerHTML = items ? items.map(i => `<li>${i}</li>`).join('') : '';
            };
            fillList('list-new', data.new_features);
            fillList('list-fixes', data.fixes);

            const optContainer = document.getElementById('opt-container');
            optContainer.innerHTML = ''; 

            if (data.optimizations && Array.isArray(data.optimizations)) {
                data.optimizations.forEach(opt => {
                    if (opt.title && opt.items) {
                        const details = document.createElement('details');
                        const summary = document.createElement('summary');
                        summary.innerHTML = `${opt.title} <span class="material-symbols-outlined text-sm transition-transform group-open:rotate-180">expand_more</span>`;
                        const contentDiv = document.createElement('div');
                        contentDiv.className = "dropdown-content";
                        const ul = document.createElement('ul');
                        ul.className = "detail-list";
                        opt.items.forEach(item => {
                            const li = document.createElement('li');
                            li.textContent = item;
                            ul.appendChild(li);
                        });
                        contentDiv.appendChild(ul);
                        details.appendChild(summary);
                        details.appendChild(contentDiv);
                        optContainer.appendChild(details);
                    } else {
                        const div = document.createElement('div');
                        div.className = "text-sm text-gray-400 p-2 border-b border-gray-700";
                        div.textContent = opt;
                        optContainer.appendChild(div);
                    }
                });
            }

            document.getElementById('utc-time-display').innerText = meta.display_time || "Unbekannt";
            if (meta.start_timestamp) {
                const date = new Date(meta.start_timestamp);
                const localStr = date.toLocaleDateString(navigator.language, { month: 'numeric', day: 'numeric', hour: '2-digit', minute: '2-digit' });
                const offset = -(date.getTimezoneOffset() / 60);
                const offsetStr = offset >= 0 ? `+${offset}` : offset;
                document.getElementById('local-time-display').innerHTML = `${localStr} <span class="text-sm font-normal text-gray-500">(UTC${offsetStr})</span>`;
            } else {
                 document.getElementById('local-time-display').innerText = "--";
            }
        }

        function changeVersion(index) { loadUpdate(index); }
        
        function filterContent(type) {
             const btns = ['all', 'major', 'opt'];
             const leftCol = document.getElementById('major-updates-section');
             const rightCol = document.getElementById('details-section');
             const mainGrid = document.querySelector('.grid');
             btns.forEach(btn => {
                 const el = document.getElementById(`btn-${btn}`);
                 if(btn === type) { el.classList.remove('text-gray-400', 'hover:text-white'); el.classList.add('bg-[#d4af37]', 'text-black'); } 
                 else { el.classList.add('text-gray-400', 'hover:text-white'); el.classList.remove('bg-[#d4af37]', 'text-black'); }
             });
             if (type === 'all') { leftCol.style.display = 'block'; rightCol.style.display = 'block'; mainGrid.classList.add('lg:grid-cols-3'); mainGrid.classList.remove('grid-cols-1'); leftCol.className = 'lg:col-span-2 space-y-8'; rightCol.className = 'lg:col-span-1 space-y-6'; } 
             else if (type === 'major') { leftCol.style.display = 'block'; rightCol.style.display = 'none'; mainGrid.classList.remove('lg:grid-cols-3'); mainGrid.classList.add('grid-cols-1'); leftCol.className = 'space-y-8 mx-auto max-w-3xl'; } 
             else if (type === 'opt') { leftCol.style.display = 'none'; rightCol.style.display = 'block'; mainGrid.classList.remove('lg:grid-cols-3'); mainGrid.classList.add('grid-cols-1'); rightCol.className = 'space-y-6 mx-auto max-w-2xl'; }
        }

        init();
    </script>
</body>
</html>
